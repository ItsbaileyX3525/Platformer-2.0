[gd_scene load_steps=25 format=3 uid="uid://bybxtflsdktqu"]

[ext_resource type="Texture2D" uid="uid://cshf2fo6eg1mk" path="res://assets/blocks/grass_dirt.png" id="1_fpix0"]
[ext_resource type="PackedScene" uid="uid://bxyoisbqmd8r8" path="res://scenes/MovingPlatform.tscn" id="2_ayage"]
[ext_resource type="PackedScene" uid="uid://ctmlu238spt3j" path="res://scenes/lever.tscn" id="3_nvmuh"]
[ext_resource type="AudioStream" uid="uid://bb6tk4bk2wjg6" path="res://assets/music/LeverSwitch.ogg" id="4_10q4k"]
[ext_resource type="Texture2D" uid="uid://do33at3qja57i" path="res://assets/blocks/levers/InactiveLever.png" id="4_ck3d0"]
[ext_resource type="Texture2D" uid="uid://56m1cuy4vomm" path="res://assets/blocks/levers/ActiveLever.png" id="5_jvxrd"]
[ext_resource type="PackedScene" uid="uid://0dgvic7mnuer" path="res://scenes/laser.tscn" id="7_wyfmu"]

[sub_resource type="GDScript" id="GDScript_yp2nr"]
script/source = "extends Node2D

#Vertical = ^
#Horizontal = <>
@onready var movingPlatHori1Anim = $Right1/AnimationPlayer
@onready var movingPlatVert1Anim = $Up1/AnimationPlayer

# Called when the node enters the scene tree for the first time.
func _ready():
	movingPlatVert1Anim.play(\"move_up\")
	movingPlatHori1Anim.play(\"move_right\")
	movingPlatHori1Anim.speed_scale = 0


# Called every frame. 'delta' is the elapsed time since the previous frame.
func _process(delta):
	pass
"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_3gjr7"]
size = Vector2(175.699, 24.4259)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_lijaw"]
size = Vector2(19.3048, 24.4201)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_5emiq"]
size = Vector2(19.4351, 24.6824)

[sub_resource type="Animation" id="Animation_vffov"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(870.169, 586.957)]
}

[sub_resource type="Animation" id="Animation_6xgxf"]
resource_name = "move_up"
length = 3.0
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1.5, 3),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [Vector2(870.169, 586.957), Vector2(870.169, 150.362), Vector2(870.169, 586.957)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_2kmfc"]
_data = {
"RESET": SubResource("Animation_vffov"),
"move_up": SubResource("Animation_6xgxf")
}

[sub_resource type="Animation" id="Animation_8vqym"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(1356.28, 627.415)]
}

[sub_resource type="Animation" id="Animation_j8lfa"]
resource_name = "move_right"
length = 3.0
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1.5, 3),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [Vector2(1309.78, 627.415), Vector2(1743.96, 627.415), Vector2(1309.78, 627.415)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_pnvme"]
_data = {
"RESET": SubResource("Animation_8vqym"),
"move_right": SubResource("Animation_j8lfa")
}

[sub_resource type="RectangleShape2D" id="RectangleShape2D_j6ejw"]
size = Vector2(19.4351, 24.42)

[sub_resource type="GDScript" id="GDScript_f6hjg"]
script/source = "extends Area2D

@onready var enabledSprite = $Enabled
@onready var disabledSprite = $Disabled
@onready var clickAudio = $AudioStreamPlayer2D
@onready var rightPlatformHoriAnim = $\"../Right1/AnimationPlayer\"

@export var state = false

# Called when the node enters the scene tree for the first time.
func _ready():
	pass # Replace with function body.


func _process(delta: float) -> void:
	if state:
		enabledSprite.visible = true
		disabledSprite.visible = false
		if rightPlatformHoriAnim.speed_scale == 0.0:
			rightPlatformHoriAnim.speed_scale = .75
	else:
		enabledSprite.visible = false
		disabledSprite.visible = true
		if rightPlatformHoriAnim.speed_scale != 0.0:
			rightPlatformHoriAnim.speed_scale = 0.0

func _physics_process(delta: float) -> void:
	var bodies = get_overlapping_bodies()
	for body in bodies:
		if body.name == \"Player\":
			if Input.is_action_just_pressed(\"click\"):
				state = not state
				clickAudio.play()
"

[sub_resource type="GDScript" id="GDScript_iqcev"]
script/source = "extends Area2D

@onready var enabledSprite = $Enabled
@onready var disabledSprite = $Disabled
@onready var clickAudio = $AudioStreamPlayer2D
@onready var platformToMove = $\"../Floor6/AnimationPlayer\"

@export var state = false

var doneComplete=true
var doneRevert=false

# Called when the node enters the scene tree for the first time.
func _ready():
	pass # Replace with function body.

func playAnim():
	doneComplete=true
	doneRevert=false
	platformToMove.speed_scale = 1
	if not platformToMove.is_playing():
		platformToMove.play(\"move_place\")
	
func reverseAnim():
	doneRevert=true
	doneComplete=false
	platformToMove.speed_scale = -1
	if not platformToMove.is_playing():
		platformToMove.seek(.999)
		platformToMove.play(\"move_place\")

func _process(delta: float) -> void:
	if state:
		enabledSprite.visible = true
		disabledSprite.visible = false
		if not doneComplete:
			playAnim()
	else:
		enabledSprite.visible = false
		disabledSprite.visible = true
		if not doneRevert:
			reverseAnim()

func _physics_process(delta: float) -> void:
	var bodies = get_overlapping_bodies()
	for body in bodies:
		if body.name == \"Player\":
			if Input.is_action_just_pressed(\"click\"):
				state = not state
				clickAudio.play()
"

[sub_resource type="Animation" id="Animation_hjd3u"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(1835.75, 1323.07)]
}

[sub_resource type="Animation" id="Animation_e5n61"]
resource_name = "move_place"
length = 1.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1.5),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(1835.75, 1323.07), Vector2(1835.75, 627.415)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_xv4d0"]
_data = {
"RESET": SubResource("Animation_hjd3u"),
"move_place": SubResource("Animation_e5n61")
}

[sub_resource type="RectangleShape2D" id="RectangleShape2D_8h0qh"]
size = Vector2(86.3495, 24.4201)

[node name="Level2" type="Node2D"]
scale = Vector2(1.656, 1.656)
script = SubResource("GDScript_yp2nr")

[node name="LevelName" type="RichTextLabel" parent="."]
offset_left = 49.5289
offset_top = 254.893
offset_right = 3131.53
offset_bottom = 1014.89
scale = Vector2(0.05, 0.05)
theme_override_colors/default_color = Color(0, 0, 0, 1)
theme_override_font_sizes/normal_font_size = 600
text = "Level 2"
scroll_active = false

[node name="Floor1" type="StaticBody2D" parent="."]
position = Vector2(198, 626.812)
scale = Vector2(4.62954, 2.29973)

[node name="Sprite2D" type="Sprite2D" parent="Floor1"]
texture_repeat = 2
position = Vector2(-42.4024, -12.0816)
scale = Vector2(0.351344, 0.815)
texture = ExtResource("1_fpix0")
centered = false
region_enabled = true
region_rect = Rect2(0.085022, 0, 500.457, 30)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Floor1"]
position = Vector2(45.3416, 0.131317)
shape = SubResource("RectangleShape2D_3gjr7")

[node name="Floor2" type="StaticBody2D" parent="."]
position = Vector2(972.222, 626.812)
scale = Vector2(4.62954, 2.29973)

[node name="Sprite2D" type="Sprite2D" parent="Floor2"]
texture_repeat = 2
position = Vector2(-9.78278, -12.3413)
scale = Vector2(0.351344, 0.815)
texture = ExtResource("1_fpix0")
centered = false
region_enabled = true
region_rect = Rect2(0.085022, 0, 55.186, 30)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Floor2"]
position = Vector2(-0.130508, -0.131226)
shape = SubResource("RectangleShape2D_lijaw")

[node name="Floor3" type="StaticBody2D" parent="."]
position = Vector2(1186.59, 626.812)
scale = Vector2(4.62954, 2.29973)

[node name="Sprite2D" type="Sprite2D" parent="Floor3"]
texture_repeat = 2
position = Vector2(-9.78278, -12.3413)
scale = Vector2(0.351344, 0.815)
texture = ExtResource("1_fpix0")
centered = false
region_enabled = true
region_rect = Rect2(0.085022, 0, 55.186, 30)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Floor3"]
position = Vector2(-0.0651855, 0.000244141)
shape = SubResource("RectangleShape2D_5emiq")

[node name="Up1" parent="." instance=ExtResource("2_ayage")]
position = Vector2(870.169, 586.957)

[node name="AnimationPlayer" type="AnimationPlayer" parent="Up1"]
libraries = {
"": SubResource("AnimationLibrary_2kmfc")
}

[node name="Right1" parent="." instance=ExtResource("2_ayage")]
position = Vector2(1356.28, 627.415)

[node name="AnimationPlayer" type="AnimationPlayer" parent="Right1"]
libraries = {
"": SubResource("AnimationLibrary_pnvme")
}

[node name="Floor4" type="StaticBody2D" parent="."]
position = Vector2(689.614, 202.899)
scale = Vector2(4.62954, 2.29973)

[node name="Sprite2D" type="Sprite2D" parent="Floor4"]
texture_repeat = 2
position = Vector2(-9.78278, -12.3413)
scale = Vector2(0.351344, 0.815)
texture = ExtResource("1_fpix0")
centered = false
region_enabled = true
region_rect = Rect2(0.085022, 0, 55.186, 30)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Floor4"]
position = Vector2(-0.0652161, -0.131287)
shape = SubResource("RectangleShape2D_j6ejw")

[node name="Lever" parent="." instance=ExtResource("3_nvmuh")]
position = Vector2(689.614, 136.473)
script = SubResource("GDScript_f6hjg")

[node name="Enabled" type="Sprite2D" parent="Lever"]
texture = ExtResource("4_ck3d0")

[node name="Disabled" type="Sprite2D" parent="Lever"]
texture = ExtResource("5_jvxrd")

[node name="AudioStreamPlayer2D" type="AudioStreamPlayer2D" parent="Lever"]
stream = ExtResource("4_10q4k")
max_distance = 1000.0

[node name="Laser" parent="." instance=ExtResource("7_wyfmu")]
position = Vector2(788.647, -75.4831)

[node name="Warning" type="RichTextLabel" parent="."]
offset_left = 890.097
offset_top = 23.5507
offset_right = 4228.1
offset_bottom = 913.551
scale = Vector2(0.05, 0.05)
theme_override_colors/default_color = Color(0, 0, 0, 1)
theme_override_font_sizes/normal_font_size = 600
text = "Careful!"
scroll_active = false

[node name="Laser2" parent="." instance=ExtResource("7_wyfmu")]
position = Vector2(1532, 737.923)
rotation = 3.14159
beamShootTime = 2.3
beamLast = 0.3

[node name="Lever2" parent="." instance=ExtResource("3_nvmuh")]
position = Vector2(1530.8, 557.367)
script = SubResource("GDScript_iqcev")

[node name="Enabled" type="Sprite2D" parent="Lever2"]
texture = ExtResource("4_ck3d0")

[node name="Disabled" type="Sprite2D" parent="Lever2"]
texture = ExtResource("5_jvxrd")

[node name="AudioStreamPlayer2D" type="AudioStreamPlayer2D" parent="Lever2"]
stream = ExtResource("4_10q4k")
max_distance = 1000.0

[node name="Floor5" type="StaticBody2D" parent="."]
position = Vector2(2309.78, 626.812)
scale = Vector2(4.62954, 2.29973)

[node name="Sprite2D" type="Sprite2D" parent="Floor5"]
texture_repeat = 2
position = Vector2(-9.78278, -12.3413)
scale = Vector2(0.351344, 0.815)
texture = ExtResource("1_fpix0")
centered = false
region_enabled = true
region_rect = Rect2(0.085022, 0, 55.186, 30)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Floor5"]
position = Vector2(-0.0652161, -0.131287)
shape = SubResource("RectangleShape2D_j6ejw")

[node name="Floor6" type="StaticBody2D" parent="."]
position = Vector2(1835.75, 1323.07)
scale = Vector2(4.62954, 2.29973)

[node name="Sprite2D" type="Sprite2D" parent="Floor6"]
texture_repeat = 2
position = Vector2(-9.78278, -12.3413)
scale = Vector2(0.351344, 0.815)
texture = ExtResource("1_fpix0")
centered = false
region_enabled = true
region_rect = Rect2(0.085022, 0, 245.785, 30)

[node name="AnimationPlayer" type="AnimationPlayer" parent="Floor6"]
libraries = {
"": SubResource("AnimationLibrary_xv4d0")
}

[node name="CollisionShape2D" type="CollisionShape2D" parent="Floor6"]
position = Vector2(33.3919, -0.131439)
shape = SubResource("RectangleShape2D_8h0qh")
